<?php
require('settings.php');
require('functions.php');
require('data.php');
?>

<html>
<head>
<title>Employee Sign-in Board</title>
<link rel="stylesheet" href="style.php" />
<?php
if ($settings['page']=='public') {
  echo('<link rel="stylesheet" href="style-public.php" />');
}
if ($settings['page']=='tablet') {
  echo('<link rel="stylesheet" href="style-tablet.php" />');
  echo('<meta name="mobile-web-app-capable" content="yes">');
  echo('<meta name="viewport" content="user-scalable=no" />');
  echo('<link rel="shortcut icon" sizes="196x196" href="signin_icon.png">');
}
if ($settings['refresh-rate'] > 0) {
  echo('<meta http-equiv="refresh" content="'.$settings['refresh-rate'].'">');
}

?>

</head>
<body>


<div class="menu-bar">
<p style="float:right;">
<a style="color:#dddddd" href="update.php" title="Update board">UPDATE BOARD</a> 
</p>

<p>
<a href="index.php?page=everyone" title="View everyone">VIEW EVERYONE</a> | 
<a href="index.php?page=public" title="View everyone">PUBLIC DISPLAY</a> | 
<a href="index.php?page=floor" title="View by floor">VIEW BY FLOOR</a> | 
<a href="index.php?page=keys" title="View keyholders">VIEW KEYHOLDERS</a> | 
<a href="index.php?page=in" title="View people currently in the building">CURRENTLY IN THE BUILDING</a>
</p>

</div>

<?php

// XXXXXX TEST CODE XXXXXX


switch ($settings['page']) {

case 'tablet' :
case 'public' :
case 'everyone' :

	$list = getEmployees();
	if (count($list)>0) {
		displayGroupList($list, null, 1);
	}
	
break;

case 'floor' :

foreach ($floors as $floor) {
	$where = 'floor = ' . $floor['id'];
	$list = getEmployees($where);
	if (count($list)>0) {
		displayGroupList($list, $floor['name'], 1);
	}
}
break;


case 'keys' :

	$where = 'keyholder = 1';
	$list = getEmployees($where);
	if (count($list)>0) {
		displayGroupList($list, 'Keyholders');
	}
break;


case 'in' :

	$where = 'status = 1';
	$list = getEmployees($where);
	if (count($list)>0) {
		displayGroupList($list, 'Currently in the building');
	}
	
break;

}

?>

</body>
</html>
